{"version":3,"file":"TrackAPI.js","sourceRoot":"","sources":["../../../../src/lib/track/TrackAPI.ts"],"names":[],"mappings":";;;;;;;;;;;;AAAA,OAAO,uBAA+D,MAAM,sCAAsC,CAAC;AAInH,OAAO,eAAe,MAAM,sBAAsB,CAAC;AASnD,MAAM,CAAC,OAAO,OAAO,QAAS,SAAQ,uBAAuB;IAC3D,KAAK,CAAC,OAAO,CAAC,MAA6B;QACzC,MAAM,cAAc,GAAG,MAAM,IAAI,CAAC,QAAQ,CAAC,YAAY,EAAE,CAAC;QAC1D,MAAM,IAAI,GAAG;YACX,QAAQ,EAAE,MAAM,CAAC,QAAQ;YACzB,YAAY,EAAE,cAAc,CAAC,OAAO;YACpC,gBAAgB,EAAE,MAAM,IAAI,CAAC,QAAQ,CAAC,SAAS,CAAC,MAAM,CAAC,gBAAgB,EAAE,CAAC,CAAC;YAC3E,iBAAiB,EAAE,MAAM,IAAI,CAAC,QAAQ,CAAC,SAAS,CAAC,MAAM,CAAC,iBAAiB,EAAE,EAAE,CAAC;YAC9E,cAAc,EAAE,MAAM,CAAC,cAAc,KAAK,SAAS,CAAC,CAAC,CAAC,MAAM,CAAC,cAAc,CAAC,CAAC,CAAC,KAAK;SACpF,CAAC;QACF,MAAM,IAAI,GAAG,MAAM,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC;QAC/C,OAAO,eAAe,CAAC,SAAS,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;IAC/C,CAAC;CACF;AAED,MAAM,OAAO,eAAgB,SAAQ,QAAQ;IAI3C,YAAY,MAA4D;QACtE,KAAK,CAAC,MAAM,CAAC,CAAC;QAHhB,2CAAkB;QAIhB,uBAAA,IAAI,4BAAY,MAAM,CAAC,OAAO,MAAA,CAAC;IACjC,CAAC;IACD,KAAK,CAAC,OAAO,CAAC,MAA6B;QACzC,OAAO,uBAAA,IAAI,gCAAS,CAAC,QAAQ,CAAC,GAAG,EAAE,CAAC,KAAK,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC,CAAC;IAC7D,CAAC;CACF","sourcesContent":["import BaseAPIWithImageSupport, { type BaseAPIWithImageSupportParams } from '../common/BaseAPIWithImageSupport.js';\nimport { type ImageFormat } from '../types/Image.js';\nimport type Track from '../types/Track.js';\nimport type Limiter from '../utils/Limiter.js';\nimport TrackInfoParser from './TrackInfoParser.js';\n\nexport interface TrackAPIGetInfoParams {\n  trackUrl: string;\n  albumImageFormat?: string | number | ImageFormat;\n  artistImageFormat?: string | number | ImageFormat;\n  includeRawData?: boolean;\n}\n\nexport default class TrackAPI extends BaseAPIWithImageSupport {\n  async getInfo(params: TrackAPIGetInfoParams): Promise<Track> {\n    const imageConstants = await this.imageAPI.getConstants();\n    const opts = {\n      trackUrl: params.trackUrl,\n      imageBaseUrl: imageConstants.baseUrl,\n      albumImageFormat: await this.imageAPI.getFormat(params.albumImageFormat, 9),\n      artistImageFormat: await this.imageAPI.getFormat(params.artistImageFormat, 21),\n      includeRawData: params.includeRawData !== undefined ? params.includeRawData : false\n    };\n    const html = await this.fetch(params.trackUrl);\n    return TrackInfoParser.parseInfo(html, opts);\n  }\n}\n\nexport class LimiterTrackAPI extends TrackAPI {\n\n  #limiter: Limiter;\n\n  constructor(params: BaseAPIWithImageSupportParams & { limiter: Limiter }) {\n    super(params);\n    this.#limiter = params.limiter;\n  }\n  async getInfo(params: TrackAPIGetInfoParams): Promise<Track> {\n    return this.#limiter.schedule(() => super.getInfo(params));\n  }\n}\n"]}